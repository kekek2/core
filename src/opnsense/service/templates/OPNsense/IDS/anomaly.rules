alert tcp any any -> any ![80,8080] (msg:"HTTP but not tcp port 80, 8080"; flow:to_server; app-layer-protocol:http; classtype:anomaly; sid:2271001; rev:1;)
alert tcp any any -> any 80 (msg:"Port 80 but not HTTP"; flow:to_server; app-layer-protocol:!http; classtype:anomaly; sid:2271002; rev:1;)
alert tcp any any -> any 443 (msg:"HTTP clear text on port 443"; flow:to_server; app-layer-protocol:http; classtype:anomaly; sid:2271019; rev:1;)
alert tcp any any -> any 443 (msg:"Port 443 but not TLS"; flow:to_server; app-layer-protocol:!tls; classtype:anomaly; sid:2271003; rev:1;)
alert tcp any any -> any ![20,21] (msg:"FTP but not tcp port 20 or 21"; flow:to_server; app-layer-protocol:ftp; classtype:anomaly; sid:2271004; rev:1;)
alert tcp any any -> any [20,21] (msg:"TCP port 21 but not FTP"; flow:to_server; app-layer-protocol:!ftp; classtype:anomaly; sid:2271005; rev:1;)
alert tcp any any -> any ![25,587,465] (msg:"SMTP but not tcp port 25,587,465"; flow:to_server; app-layer-protocol:smtp; classtype:anomaly; sid:2271006; rev:1;)
alert tcp any any -> any [25,587,465] (msg:"TCP port 25,587,465 but not SMTP"; flow:to_server; app-layer-protocol:!smtp; classtype:anomaly; sid:2271007; rev:1;)
alert tcp any any -> any !22 (msg:"SSH but not tcp port 22"; flow:to_server; app-layer-protocol:ssh; classtype:anomaly; sid:2271008; rev:1;)
alert tcp any any -> any 22 (msg:"TCP port 22 but not SSH"; flow:to_server; app-layer-protocol:!ssh; classtype:anomaly; sid:2271009; rev:1;)
alert tcp any any -> any !143 (msg:"IMAP but not tcp port 143"; flow:to_server; app-layer-protocol:imap; classtype:anomaly; sid:2271010; rev:1;)
alert tcp any any -> any 143 (msg:"TCP port 143 but not IMAP"; flow:to_server; app-layer-protocol:!imap; classtype:anomaly; sid:2271011; rev:1;)
alert tcp any any -> any 139 (msg:"TCP port 139 but not SMB"; flow:to_server; app-layer-protocol:!smb; classtype:anomaly; sid:2271012; rev:1;)
alert tcp any any -> any [80,8080] (msg:"DCERPC detected over port tcp 80,8080"; flow:to_server; app-layer-protocol:dcerpc; classtype:anomaly; sid:2271013; rev:1;)
alert tcp any any -> any 53 (msg:"TCP port 53 but not DNS"; flow:to_server; app-layer-protocol:!dns; classtype:anomaly; sid:2271014; rev:1;)
alert udp any any -> any 53 (msg:"UDP port 53 but not DNS"; flow:to_server; app-layer-protocol:!dns; classtype:anomaly; sid:2271015; rev:1;)
alert tcp any any -> any 502 (msg:"TCP port 502 but not MODBUS"; flow:to_server; app-layer-protocol:!modbus; classtype:anomaly; sid:2271018; rev:1;)
