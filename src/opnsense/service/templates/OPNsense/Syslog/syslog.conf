# autogenerated configuration file for syslog, do not edit
{% set allsources = [] %}
{% for source in helpers.toList('OPNsense.Syslog.LogSources.Source') %}
{%		do allsources.append(source.Program) %}
{%		for target in helpers.toList('OPNsense.Syslog.LogTargets.Target') %}
{%			if target.Source|default('') == source.Program %}
{%				if OPNsense.Syslog.DisableLogFiles|default(0) == '0' and target.ActionType == 'file' %}
!{{ target.Source }}
{{target.Filter}}								{{target.Target}}
{%				endif %}
{%				if target.ActionType != 'file' %}
!{{ target.Source }}
{{target.Filter}}								{% if target.ActionType == 'pipe' %}|{% endif %}{% if target.ActionType == 'remote' %}@{% endif %}{{target.Target}}
{%				endif %}
{% 				if OPNsense.Syslog.Remote.Enable|default(0) == '1' and OPNsense.Syslog.Remote.Servers|length > 0 and OPNsense.Syslog.Remote.LogAll|default(0) == '0' %}
{%					for category in helpers.toList('OPNsense.Syslog.LogCategories.Category') %}
{%						if  category.Name == target.Category  and category.LogRemote == '1' %}
!{{ target.Source }}
{%							for server in OPNsense.Syslog.Remote.Servers.split(',') %}
{{target.Filter}}								@{{server}}
{%							endfor %}
{%						endif %}
{%					endfor %}
{%				endif %}
{%			endif %}
{%		endfor %}
{% endfor %}

!-{{ allsources|sort|join(',') }}
{%		for target in helpers.toList('OPNsense.Syslog.LogTargets.Target') %}
{%			if target.Source|default('') == '' %}
{%				if OPNsense.Syslog.DisableLogFiles|default(0) == '0' and target.ActionType == 'file' %}
{{target.Filter}}								{{target.Target}}
{%				endif %}
{%				if target.ActionType != 'file' %}
{{target.Filter}}								{% if target.ActionType == 'pipe' %}|{% endif %}{% if target.ActionType == 'remote' %}@{% endif %}{{target.Target}}
{%				endif %}
{% 				if OPNsense.Syslog.Remote.Enable|default(0) == '1' and OPNsense.Syslog.Remote.Servers|length > 0  and OPNsense.Syslog.Remote.LogAll|default(0) == '0' %}
{%					for category in helpers.toList('OPNsense.Syslog.LogCategories.Category') %}
{%						if  category.Name == target.Category  and category.LogRemote == '1' %}
{%							for server in OPNsense.Syslog.Remote.Servers.split(',') %}
{{target.Filter}}								@{{server}}
{%							endfor %}
{%						endif %}
{%					endfor %}
{%				endif %}
{%			endif %}
{%		endfor %}

{% 		if OPNsense.Syslog.Remote.Enable|default(0) == '1' and OPNsense.Syslog.Remote.Servers|length > 0  and OPNsense.Syslog.Remote.LogAll|default(0) == '1' %}
!*
{%			for server in OPNsense.Syslog.Remote.Servers.split(',') %}
*.*											@{{server}}
{%			endfor %}
{%		endif %}
